<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تسجيل دخول الطالبة</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo&family=Scheherazade&display=swap" rel="stylesheet">
<style>
body {
    font-family:'Cairo', sans-serif;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    background:#cceeff;
    margin:0;
}
.login-box {
    background:#e6ffe6;
    padding:40px;
    border-radius:15px;
    box-shadow:0 5px 20px rgba(0,0,0,0.3);
    max-width:400px;
    width:90%;
}
.login-box h2 {
    text-align:center;
    font-family:'Scheherazade', serif;
    margin-bottom:30px;
    color:#32CD32;
}
.login-box label {display:block; margin:10px 0 5px;}
.login-box input[type="text"],
.login-box input[type="password"] {
    width:100%; padding:10px; border-radius:10px; border:1px solid #32CD32; font-size:1em;
}
.login-box input[type="checkbox"] {margin-left:5px; cursor:pointer;}
.login-box button {
    width:100%;
    margin-top:20px;
    padding:12px;
    font-size:1.2em;
    background:#32CD32;
    color:white;
    border:none;
    border-radius:10px;
    cursor:pointer;
    transition:0.3s;
}
.login-box button:hover {transform:scale(1.05);}
@media(max-width:500px){
    .login-box {padding:30px;}
    .login-box button {font-size:1em; padding:10px;}
}
</style>
</head>
<body>
<div class="login-box">
  <h2>تسجيل دخول الطالبة</h2>
  <label>اسم المستخدم</label>
  <input type="text" id="username" placeholder="أدخل اسم المستخدم">
  <label>كلمة المرور</label>
  <input type="password" id="password" placeholder="أدخل كلمة المرور">
  <label><input type="checkbox" id="rememberMe"> تذكرني</label>
  <button id="loginBtn">تسجيل الدخول</button>
</div>

<script>
// ===== Config =====
const scriptURL = "https://script.google.com/macros/s/AKfycbyW-GfeDlzrygGp3GsOrHckdVLzw4ZhUUXvqwpWHPeyub1HRsaACQZ9qEMQ63lL96Vg/exec";

// ===== Login Handler =====
function login() {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();
    const remember = document.getElementById('rememberMe').checked;

    if(!username || !password){ 
        alert("يرجى ملء جميع الحقول!"); 
        return; 
    }

    fetch(`${scriptURL}?action=login&username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`)
    .then(res => res.json())
    .then(data => {
        if(data.success){
            // Store login info
            if(remember) localStorage.setItem('studentLoggedIn', username);
            sessionStorage.setItem('studentLoggedIn', username);

            // Redirect to student page
            const redirectUrl = new URLSearchParams(window.location.search).get('redirect') || 'student.html';
            window.location.href = redirectUrl;
        } else {
            alert(data.message || "اسم المستخدم أو كلمة المرور خاطئة!");
        }
    })
    .catch(err => {
        console.error(err);
        alert("خطأ في الاتصال بالخادم!");
    });
}

// Button click
document.getElementById('loginBtn').addEventListener('click', login);

// Enter key support
document.getElementById('password').addEventListener('keypress', (e) => {
    if(e.key === 'Enter') login();
});
document.getElementById('username').addEventListener('keypress', (e) => {
    if(e.key === 'Enter') login();
});
</script>
</body>
</html>
